!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cmblapi",[],t):"object"==typeof exports?exports.cmblapi=t():e.cmblapi=t()}(window,function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var a,i,o;i=[t],void 0===(o="function"==typeof(a=function(n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callbackFuncs={},this.haveShowed=!1}return t=e,(n=[{key:"version",value:function(){return{version:"10.1.0",buildTime:"20220107112517",env:"pro.min"}}},{key:"_appVersion",value:function(){try{var e=navigator.userAgent.toLowerCase(),t=e.match(/mpbank\/(\d+\.\d+\.\d+)/);return t?t[1]:""}catch(e){return""}}},{key:"_upgradePrompt",value:function(){var e=this;this.showPrompt({type:"dialog",style:{title:"App升级提示",content:"您的招商银行App版本过低，可能会导致无法正常使用当前功能",buttonStyle:[{type:"negative",text:"稍后更新"},{type:"positive",text:"立即更新"}]},onBtnClicked:function(t){if(0==t.index)console.log("用户取消"),e.recordEventLog({eventId:"ClickUnload",behavior:{WidgetStatus:"",ProdCode:"",WidgetNo:"X50001002"},success:function(e){},fail:function(e){console.log(e)}});else{e.recordEventLog({eventId:"ClickUnload",behavior:{WidgetStatus:"",ProdCode:"",WidgetNo:"X50001001"},success:function(e){},fail:function(e){console.log(e)}});var n=navigator.userAgent.toLowerCase();n.indexOf("android")>-1?e.callOtherApp({schemeUrl:"market://details?id=cmb.pb",success:function(){},fail:function(e){console.log(e)}}):n.indexOf("iphone")>-1&&e.callOtherApp({schemeUrl:"itms-apps://itunes.apple.com/cn/app/zhao-shang-yin-xing/id392899425?mt=8",success:function(){},fail:function(e){console.log(e)}})}},success:function(){},fail:function(e){console.log(e)}})}},{key:"cmblapiCall",value:function(e,t){try{(t=t||{})._jsVer="10.1.0",t._jsBuildTime="20220107112517";var n=(new Date).getTime().toString()+Math.round(1e4*Math.random()).toString();if(null==n||""===n)return;for(var a in t)if("function"==typeof t[a]){var i=n+a;this.callbackFuncs[i]=t[a]}var o=JSON.stringify(t);if(null==o||""===o)return;window.cmblapiBridge?window.cmblapiBridge.invoke(n,e,o):document.addEventListener("cmblapiJSBridgeReady",function(){window.cmblapiBridge.invoke(n,e,o)},!1)}catch(e){console.log(e)}}},{key:"callback",value:function(e,t,n){try{if(null==e||""===e)return;if(null==t||""===t)return;var a=this.callbackFuncs[e+t];if("function"==typeof a)if(null==n||""===n)a();else{var i=JSON.parse(n);if(null!=i&&""!==i&&void 0!==i.errCode&&null!==i.errCode&&1===i.errCode&&0==this.haveShowed)return this.haveShowed=!0,void this._upgradePrompt();a(i)}}catch(e){console.log(e)}}},{key:"callbackWithObj",value:function(e,t,n){if(null!=n&&""!==n&&void 0!==n.errCode&&null!==n.errCode&&1===n.errCode&&0==this.haveShowed)return this.haveShowed=!0,void this._upgradePrompt();try{if(null==e||""===e)return;if(null==t||""===t)return;var a=this.callbackFuncs[e+t];"function"==typeof a&&(null==n||""===n?a():a(n),"undefined"!==a._needRemove&&!0===a._needRemove&&delete this.callbackFuncs[e+t])}catch(e){console.log(e)}}},{key:"checkJsApi",value:function(e){this.cmblapiCall("checkJsApi",e)}},{key:"getSystemInfo",value:function(e){this.cmblapiCall("getSystemInfo",e)}},{key:"requestUserPermission",value:function(e){this.cmblapiCall("requestUserPermission",e)}},{key:"config",value:function(e){this.cmblapiCall("config",e)}},{key:"getLocation",value:function(e){this.cmblapiCall("getLocation",e)}},{key:"showNavigationBar",value:function(e){this.cmblapiCall("showNavigationBar",e)}},{key:"hideNavigationBar",value:function(e){this.cmblapiCall("hideNavigationBar",e)}},{key:"setNavigationBarStyle",value:function(e){this.cmblapiCall("setNavigationBarStyle",e)}},{key:"setNavigationBarTitle",value:function(e){this.cmblapiCall("setNavigationBarTitle",e)}},{key:"setLeftNavigationBar",value:function(e){this.cmblapiCall("setLeftNavigationBar",e)}},{key:"setRightNavigationBar",value:function(e){this.cmblapiCall("setRightNavigationBar",e)}},{key:"pushWindow",value:function(e){this.cmblapiCall("pushWindow",e)}},{key:"popWindow",value:function(e){this.cmblapiCall("popWindow",e)}},{key:"setWindowProperties",value:function(e){this.cmblapiCall("setWindowProperties",e)}},{key:"setStatusBarStyle",value:function(e){this.cmblapiCall("setStatusBarStyle",e)}},{key:"showDropDownMenu",value:function(e){this.cmblapiCall("showDropDownMenu",e)}},{key:"shareInfo",value:function(e){this.cmblapiCall("shareInfo",e)}},{key:"shareInfoWithUI",value:function(e){this.cmblapiCall("shareInfoWithUI",e)}},{key:"showShareMenu",value:function(e){this.cmblapiCall("showShareMenu",e)}},{key:"createShortcut",value:function(e){this.cmblapiCall("createShortcut",e)}},{key:"makePhoneCall",value:function(e){this.cmblapiCall("makePhoneCall",e)}},{key:"watchShake",value:function(e){this.cmblapiCall("watchShake",e)}},{key:"queryContact",value:function(e){this.cmblapiCall("queryContact",e)}},{key:"callAndroidNFC",value:function(e){this.cmblapiCall("callAndroidNFC",e)}},{key:"queryNFC",value:function(e){this.cmblapiCall("queryNFC",e)}},{key:"closeNFC",value:function(e){this.cmblapiCall("closeNFC",e)}},{key:"scanNFC",value:function(e){this.cmblapiCall("scanNFC",e)}},{key:"setNFCTimeout",value:function(e){this.cmblapiCall("setNFCTimeout",e)}},{key:"transceiveNFC",value:function(e){this.cmblapiCall("transceiveNFC",e)}},{key:"callBluetoothFunc",value:function(e){this.cmblapiCall("callBluetoothFunc",e)}},{key:"callZhaoHuFunc",value:function(e){this.cmblapiCall("callZhaoHuFunc",e)}},{key:"makeBarcodeImage",value:function(e){this.cmblapiCall("makeBarcodeImage",e)}},{key:"scanBarcode",value:function(e){this.cmblapiCall("scanBarcode",e)}},{key:"scanIDCard",value:function(e){this.cmblapiCall("scanIDCard",e)}},{key:"scanBankCard",value:function(e){this.cmblapiCall("scanBankCard",e)}},{key:"callOtherApp",value:function(e){this.cmblapiCall("callOtherApp",e)}},{key:"jumpSetting",value:function(e){this.cmblapiCall("jumpSetting",e)}},{key:"appStorage",value:function(e){this.cmblapiCall("appStorage",e)}},{key:"chooseImage",value:function(e){this.cmblapiCall("chooseImage",e)}},{key:"saveImageToAlbum",value:function(e){this.cmblapiCall("saveImageToAlbum",e)}},{key:"snapshotPage",value:function(e){this.cmblapiCall("snapshotPage",e)}},{key:"addAppEventListener",value:function(e){var t=this._appVersion(),n=navigator.userAgent.toLowerCase();n.indexOf("iphone")>-1&&"undefined"!==t&&parseFloat(t)<8.2&&"undefined"!==e.constant&&!1===e.constant&&"function"==typeof e.on&&(e.on._needRemove=!0,e.constant=!0),this.cmblapiCall("addAppEventListener",e)}},{key:"login",value:function(e){this.cmblapiCall("login",e)}},{key:"merchantLogin",value:function(e){this.cmblapiCall("merchantLogin",e)}},{key:"setBrightness",value:function(e){this.cmblapiCall("setBrightness",e)}},{key:"applet",value:function(e){this.cmblapiCall("applet",e)}},{key:"merchantOpenAPI",value:function(e){this.cmblapiCall("merchantOpenAPI",e)}},{key:"footprint",value:function(e){this.cmblapiCall("footprint",e)}},{key:"CTID",value:function(e){this.cmblapiCall("CTID",e)}},{key:"clearNavigationBar",value:function(e){this.cmblapiCall("clearNavigationBar",e)}},{key:"callAIAssistFunc",value:function(e){this.cmblapiCall("callAIAssistFunc",e)}},{key:"getDeviceInfo",value:function(e){this.cmblapiCall("getDeviceInfo",e)}},{key:"uploadFile",value:function(e){this.cmblapiCall("uploadFile",e)}},{key:"openDataPickerView",value:function(e){this.cmblapiCall("openDataPickerView",e)}},{key:"calendarReminder",value:function(e){this.cmblapiCall("calendarReminder",e)}},{key:"listenBluetoothEvent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.eventNames,a=t.on,i=t.success,o=t.fail;if(Array.isArray(n))if("function"==typeof a){var l=["onAdapterStateChange","onDeviceFound","onServicesDiscovered","onConnectionStateChange","onCharacteristicValueChange","onWriteResponse"];for(var c in n)if(-1===l.indexOf(n[c]))return void("function"==typeof o&&o({errCode:2,errMsg:"参数异常"}));if(this.callBluetoothFunc){var r=function(t){e.callBluetoothFunc[n[t]]=function(e){a({eventName:n[t],message:e})}};for(var u in n)r(u);"function"==typeof i&&i()}else"function"==typeof o&&o({errCode:3,errMsg:"发生未知错误"})}else"function"==typeof o&&o({errCode:2,errMsg:"参数异常"});else"function"==typeof o&&o({errCode:2,errMsg:"参数异常"})}},{key:"netpay",value:function(e){this.cmblapiCall("netpay",e)}},{key:"addCustomEventListener",value:function(e){this.cmblapiCall("addCustomEventListener",e)}},{key:"dispatchCustomEvent",value:function(e){this.cmblapiCall("dispatchCustomEvent",e)}},{key:"requestAccuracyLocation",value:function(e){this.cmblapiCall("requestAccuracyLocation",e)}},{key:"checkAppVerMatch",value:function(e){this.cmblapiCall("checkAppVerMatch",e)}},{key:"vibrate",value:function(e){this.cmblapiCall("vibrate",e)}},{key:"querySetting",value:function(e){this.cmblapiCall("querySetting",e)}},{key:"voice2text",value:function(e){this.cmblapiCall("voice2text",e)}},{key:"travelCode",value:function(e){this.cmblapiCall("travelCode",e)}},{key:"forbidSnap",value:function(e){this.cmblapiCall("forbidSnap",e)}},{key:"debug",value:function(e){this.cmblapiCall("debug",e)}},{key:"showPrompt",value:function(e){this.cmblapiCall("showPrompt",e)}},{key:"recordEventLog",value:function(e){this.cmblapiCall("recordEventLog",e)}},{key:"merchantUniAuth",value:function(e){var t=e.success,n=e.fail,i=(navigator.userAgent.match(/MPBank\/(.+?) /)?navigator.userAgent.match(/MPBank\/(.+?) /)[1]:"9.2.0").split("."),o=i[0]>9||9==i[0]&&i[1]>=2;if(0==o)return void 0!==n&&"function"==typeof n?void n({errCode:100,errMsg:"该接口仅支持9.2.0及其以上的客户端"}):void 0;cmblapi.getSystemInfo({success:function(i){if(1!=i.isLogin)return void 0!==n&&"function"==typeof n?void n({errCode:101,errMsg:"用户未登录"}):void 0;if(cmblapi.addCustomEventListener({eventName:"AppInternal_MerchantUniAuth_ResponseData",on:function(e){try{var a=JSON.parse(e.message);"0000"===a.errCode?void 0!==t&&"function"==typeof t&&t(a):void 0!==n&&"function"==typeof n&&n(a)}catch(e){void 0!==n&&"function"==typeof n&&n(json)}},fail:function(e){void 0!==n&&"function"==typeof n&&n(e)}}),"string"!=typeof e.param||""===e.param)return void 0!==n&&"function"==typeof n?void n({errCode:102,errMsg:"无效参数param"}):void 0;var o=encodeURIComponent(e.param);if("object"!==a(e.authInfo))return void 0!==n&&"function"==typeof n?void n({errCode:103,errMsg:"无效参数authInfo"}):void 0;var l=encodeURIComponent(JSON.stringify(e.authInfo)),c=JSON.stringify({WindowProperties:{HistoryBackSupport:!0,ShowTopBar:!1,FullScreen:!0,WindowBackgroundColor:"#00000000"}}),r=encodeURIComponent(c);window.location.href="http://cmbls/FunctionJump?id=1&action=gofuncid&funcid=0158041&clean=false&requesttype=post&cmb_app_trans_parms_start=here&authInfo=".concat(l,"&pbparam=").concat(o,"&cmb_app_params=").concat(r)}})}},{key:"rbsVerify",value:function(e){this.cmblapiCall("rbsVerify",e)}},{key:"liveStream",value:function(e){this.cmblapiCall("liveStream",e)}},{key:"callMerchantOpenAPI",value:function(e){this.cmblapiCall("callMerchantOpenAPI",e)}},{key:"notificationAuth",value:function(e){this.cmblapiCall("notificationAuth",e)}},{key:"liveStreamFloatWindow",value:function(e){this.cmblapiCall("liveStreamFloatWindow",e)}},{key:"setLiveStreamWindowProperties",value:function(e){this.cmblapiCall("setLiveStreamWindowProperties",e)}},{key:"readNFCData",value:function(e){this.cmblapiCall("readNFCData",e)}},{key:"writeNFCData",value:function(e){this.cmblapiCall("writeNFCData",e)}},{key:"appletSimplifyInfo",value:function(e){this.cmblapiCall("appletSimplifyInfo",e)}},{key:"mapPreview",value:function(e){this.cmblapiCall("mapPreview",e)}}])&&i(t.prototype,n),o&&i(t,o),e;var t,n,o}();void 0===window.cmblapi&&(window.cmblapi=new o);var l=window.cmblapi;n.default=l,e.exports=t.default})?a.apply(t,i):a)||(e.exports=o)}])});